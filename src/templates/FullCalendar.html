<!DOCTYPE html>

<head>
	<meta charset="UTF-8">
	<title></title>
	<link rel='stylesheet' href="{{ url_for('static', filename='css/fullcalendar.css') }}"/>
	<link rel='stylesheet' href="{{ url_for('static', filename='css/externalEvents.css') }}"/>
	<script src='{{ url_for("static", filename="js/jquery.min.js") }}'></script>
	<script src='{{ url_for("static", filename="js/jquery-ui.min.js") }}'></script>
	<script src='{{ url_for("static", filename="js/moment.min.js") }}'></script>
	<script src='{{ url_for("static", filename="js/fullcalendar.js") }}'></script>
</head>

<script>
	$(function() {
	
		// page is now ready, initialize the calendar...
		$("#external-events .fc-event").each(function() {

		// store data so the calendar knows to render an event upon drop
			$(this).data("event", {
				title: $.trim($(this).text()), // use the element's text as the event title
				stick: true // maintain when user navigates (see docs on the renderEvent method)
			});

		// make the event draggable using jQuery UI
			$(this).draggable({
				zIndex: 999,
				revert: true,      // will cause the event to go back to its
				revertDuration: 0  //  original position after the drag
			});

		});
	
		$('#calendar').fullCalendar({
			weekends: false,
			// defaultView: 'agendaFiveDay',
			header: { 
				left: 'prev,next,today', // buttons to change date view
				center: 'title', // current
				right: 'month,agendaWeek,agendaDay' // buttons for switching view type
			}, 
			editable: true,
			droppable: true, // this allows things to be dropped onto the calendar
			drop: function() {
				// is the "remove after drop" checkbox checked?
				$(this).remove();
			},
		});
	});
</script>


<body>	
	<div id="calendar-container" >
		<div id="calendar"></div>
	</div>
	
	<div id='external-events'>
		<p>
			<strong>Events</strong>
		</p>
		{% for task in tasks %}

			<div class='fc-event'>{{ task["content"] }} <br>
				<br>
				start: {{ task["start_date"] }} <br>
				due: {{ task["due_date"] }}
			</div>
		{% endfor %}

	</div>
	<form method="get" action="{{ url_for('pull_data_from_api') }}">
		<button>refresh</button>
	</form>
</body>

</html>